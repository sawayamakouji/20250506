この「発注・配分ワークフロー（金額合計表示）」アプリの使い方について、ステップごとにご説明します。
発注・配分ワークフロー アプリの使い方
このアプリは、ExcelやCSVファイルから商品データを読み込み、店舗ごとの発注数量を入力し、その商品を仮想の「パケット」に仕分けて管理するためのツールです。
ステップ0: ファイルの準備
データファイルの形式:
Excelファイル (.xlsx, .xls) または CSVファイル (.csv) を用意します。
必須列: アプリが認識する主要な商品情報列（「伝票日付」「チラシ日」「JAN」「商品名」「本体売価」など）と、店舗ごとの提案数量（または実績数量）が含まれている必要があります。
Excelの場合の注意点:
データは「新データ入力」という名前のシートに含まれている必要があります。
ヘッダー行（「伝票日付」などの列名が記載されている行）は、シートの6行目、7行目、または8行目にあることを想定しています。
「JAN」「メーカー名」「商品名」「規格」「発注単位」「原価」「本体売価」「総額売価」のいずれにも値が入っていない行は無視されます。
CSVの場合の注意点:
1行目がヘッダー行であると想定しています。
Excelと同様に、主要なキー項目が空の行は読み込み時に無視されます。
ステップ1: 発注数量入力
ファイル選択:
画面上部の「ファイル選択」ボタン（またはその隣の領域）をクリックし、準備したデータファイルを選択します。複数のファイルを同時に選択することも可能です。
ファイルが読み込まれると、データに基づいて「対象店舗」のドロップダウンリストが更新されます。
対象店舗の選択:
「対象店舗」ドロップダウンリストから、発注数量を入力したい店舗を選択します。
選択すると、下部のテーブルにその店舗の商品データが表示されます。
テーブルの表示項目:
取得ファイル名: どのファイルから読み込まれたデータかを示します。
伝票日付, チラシ日, ..., 備考: 商品の基本情報です。
提案数量: ファイル内で選択した店舗の列に記載されていた数量です。
発注数量: ここに実際の発注数を入力します。初期値として提案数量が設定され、発注単位で丸められます。
発注数量の入力:
各商品の「発注数量」列の入力欄に、発注したい数量を入力します。
数量は、その商品の「発注単位」の倍数になるように自動調整されます（入力欄からフォーカスが外れた時など）。マイナス値は0に補正されます。
全発注リストのダウンロード (任意):
テーブル上部右側の「全発注リストダウンロード(CSV)」ボタンをクリックすると、現在選択している店舗の全商品データ（ページ分割されていても全件）と、入力された発注数量がCSVファイルとしてダウンロードされます。
次へ (ステップ2へ進む):
発注数量の入力が完了したら、「次へ」ボタンをクリックして「ステップ2: パケット配分」に進みます。
この時、ステップ1で「発注数量」が1以上の商品のみが、ステップ2の商品リストの対象となります。
ステップ2: パケット配分
このステップでは、ステップ1で発注数量が入力された商品を、任意の「パケット」にドラッグ＆ドロップで仕分けます。各パケット内の商品の合計金額も表示されます。
画面構成:
左側 (商品リスト): ステップ1で発注数量が1以上の商品がリスト表示されます。商品名と括弧内に発注数量が表示されています。
右側 (パケットエリア): 商品をドラッグ＆ドロップで入れるための「パケット」が表示されます。
各パケットには編集可能な名前と、そのパケット内の商品の「本体売価 × 発注数量」の合計金額が表示されます。
パケットへの配分:
左側の「商品リスト」から、配分したい商品を右側の任意のパケットの枠内にドラッグ＆ドロップします。
複数の商品を一度に選択してドラッグすることも可能です（CtrlキーまたはShiftキーを押しながら商品をクリック）。
商品がパケットに移動すると、パケット下部の合計金額が自動的に更新されます。
一度パケットに入れた商品を別のパケットに移動したり、商品リストに戻したりすることも可能です。
パケット内で商品の順番を並び替えることもできます。
パケットの操作:
パケット追加: 右上の「パケット追加」ボタンをクリックすると、新しい空のパケットが追加されます。
パケット名変更: 各パケットの上部にあるパケット名（例: "パケットA"）をクリックすると、名前を直接編集できます。Enterキーを押すか、フォーカスを外すと変更が確定します。
パケット構成の保存・読込:
構成保存: 右上の「構成保存」ボタンをクリックすると、現在のパケットの構成（パケットの名前と数）が packet_config.json というファイルでダウンロードされ、同時にブラウザのローカルストレージにも保存されます。注意: 配分された商品の内容は保存されません。パケットの枠組みのみが保存されます。
構成読込: 右上の「構成読込」ボタンをクリックすると、ファイル選択ダイアログが開きます。以前に「構成保存」でダウンロードした packet_config.json ファイルを選択すると、その構成でパケットが復元されます。ローカルストレージにも保存されます。
自動読込: アプリを再度開いた際には、前回ローカルストレージに保存されたパケット構成が自動的に読み込まれます。
CSVダウンロード (配分結果):
右上の「CSVダウンロード」ボタンをクリックすると、現在のパケット配分状況がCSVファイルとしてダウンロードされます。
CSVファイルには、各商品がどのパケットに属しているか、商品の詳細情報（取得ファイル名、伝票日付、商品名、数量、単価、合計金額など）が含まれます。
この使い方説明が、アプリをより効果的にご活用いただく一助となれば幸いです。
ご不明な点や、さらに改善のご要望がございましたら、お気軽にお知らせください。
